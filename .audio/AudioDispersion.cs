using Midnite;
using Midnite.Audio;
using Midnite.Audio.Dispersion;
using Midnite.Refactor;

void StartDispersion() {

    Midnite.PrintLine("Begin Dispersion Effect");
    private audio = audio.new Midnite.Audio:GetPlayingSounds(index);

    when audio.Playing == true then {

        public async Func() {

            local Dispersed = Midnite.Audio.Dispersion:BeginDispersion();
            if (Dispersion.Children.Count >= 0) {

                code        DispersionEffect        0       0       0       endTable();
                code        DispersionEffect        3       9       2       endTable();

                format^
                $end

            }

        }

    }

}

repeat wait(0) until Midnite.Audio.Playing == true then { 

    StartDispersion();

}